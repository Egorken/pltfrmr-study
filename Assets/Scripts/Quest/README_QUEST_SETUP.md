# Настройка системы заданий и квестов

Пошаговая настройка: UI задания, менеджер квестов, NPC с квестами, предмет и босс.

---

## Шаг 1. Quest Manager (один раз на сцену)

1. В сцене создай **пустой объект** (ПКМ в Hierarchy → Create Empty).
2. Назови его, например, **QuestManager**.
3. Добавь компонент **Quest Manager** (Add Component → поиск "Quest Manager").
4. В инспекторе:
   - **No Quest Display Text** — текст, когда задания нет (по умолчанию: «Исследуйте местность»).

Больше ничего не настраивай. Этот объект должен быть в каждой сцене, где есть квесты или UI задания.

---

## Шаг 2. UI текущего задания

1. Открой свой **Canvas** (главный UI).
2. Создай панель для задания:
   - ПКМ по Canvas → **UI → Panel** (или пустой объект).
   - Назови, например, **QuestPanel**.
3. Внутри панели создай текст заголовка:
   - ПКМ по QuestPanel → **UI → Text - TextMeshPro** (если спросит про TMP Essentials — Import).
   - Назови **QuestTitle**. Текст: `Текущее задание:`
   - Подгони размер, шрифт, позицию (например сверху экрана).
4. Внутри панели создай второй текст — само задание:
   - Ещё один **UI → Text - TextMeshPro**, назови **QuestObjective**.
   - Текст можно оставить пустым или «Исследуйте местность» — скрипт его заменит.
   - Расположи под заголовком.
5. На **QuestPanel** (или на отдельный объект с этими текстами) добавь компонент **Quest UI**.
6. В **Quest UI** в инспекторе:
   - **Title Text** — перетащи сюда **QuestTitle**.
   - **Title Label** — оставь `Текущее задание:` или измени по желанию.
   - **Objective Text** — перетащи **QuestObjective**.

После запуска сцены в UI будет отображаться текущее задание или «Исследуйте местность».

---

## Шаг 3. NPC, который даёт задание

1. Создай или выбери объект NPC (спрайт, коллайдер и т.п.).
2. Добавь **Collider 2D** (например Box Collider 2D):
   - Включи **Is Trigger**.
   - Подгони размер так, чтобы игрок «входил» в зону разговора.
3. Добавь компонент **Talkable NPC**.
4. **Диалог:**
   - **Dialog Lines** — Size = число реплик, в каждом элементе — текст (например: «Привет!», «Нужна твоя помощь.»).
   - **Auto Advance After** — 0, если переключать только по кнопке E.
5. **Квест:**
   - Включи **Give Quest After Dialog**.
   - **Quest Type** — выбери:
     - **Fetch** — «найди предмет и принеси»;
     - **Kill Boss** — «убить босса».
   - **Quest Description** — текст, который увидит игрок в блоке «Текущее задание» (например: «Найди красную ключ-карту и принеси её мне.» или «Победи босса впереди.»).
   - Для **Fetch**:
     - **Fetch Item Type** = **Quest Key**;
     - **Completion Line** — что скажет NPC при сдаче (например: «Спасибо! Задание выполнено.»).
   - Для **Kill Boss**:
     - **Kill Boss Target** — сюда перетащи объект босса со сцены (настроишь на шаге 5).
6. **Взаимодействие:**
   - **Dialog Bubble** и **Dialog Text Field** — если у NPC есть дочерний Canvas с диалогом, перетащи сюда или оставь пусто (скрипт попробует найти сам).
7. **Player Tag** — тег игрока (обычно **Player**). У объекта игрока должен быть этот тег.

Итог: игрок подходит, нажимает E, читает диалог; после последней реплики выдаётся квест и в UI появляется текст задания.

---

## Шаг 4. Предмет для квеста «принести» (если квест типа Fetch)

1. Создай объект на уровне (например пустой или со спрайтом «ключ»).
2. Добавь **Collider 2D** и включи **Is Trigger**.
3. Добавь компонент **Item Pickup** (из папки Inventory).
4. В **Item Pickup**:
   - **Item Type** = **Quest Key** (квестовый предмет).
5. Размести предмет там, где игрок должен его «найти».

Игрок подбирает предмет (он попадает в инвентарь), затем возвращается к NPC и снова нажимает E — NPC забирает предмет и говорит Completion Line, задание снимается, в UI снова «Исследуйте местность» (или следующий квест, если добавишь).

---

## Шаг 5. Босс для квеста «убить босса» (если квест типа Kill Boss)

1. Возьми своего босса (объект с врагом) или создай нового.
2. На нём должны быть:
   - **Enemy Health** (как у обычного врага).
   - **Collider 2D**, скрипты движения/стрельбы и т.д. — как у врага.
3. Добавь на этого же объект компонент **Quest Target Boss** (из папки Quest).
4. Ничего больше в **Quest Target Boss** настраивать не нужно.
5. Вернись к NPC, который даёт квест «убить босса»:
   - В поле **Kill Boss Target** перетащи **именно этот объект босса** (тот, на котором висит Quest Target Boss).

После смерти босса квест завершится сам, в UI снова отобразится «Исследуйте местность» (или что задано в Quest Manager).

---

## Порядок проверки

1. Запусти сцену — в UI должно быть «Текущее задание: Исследуйте местность.» (если Quest Manager и Quest UI настроены).
2. Подойди к NPC, нажми E — диалог, после последней реплики — в UI меняется на текст задания.
3. **Fetch:** подбери предмет (Quest Key), вернись к NPC, нажми E — реплика «Спасибо!», задание пропадает из UI.
4. **Kill Boss:** дойди до босса, убей его — задание пропадает из UI без разговора с NPC.

---

## Краткий чеклист

- [ ] В сцене есть объект с **Quest Manager**.
- [ ] На Canvas есть панель с двумя TMP_Text и компонентом **Quest UI**, ссылки на тексты проставлены.
- [ ] У NPC есть **Collider 2D (Trigger)** и **Talkable NPC**, диалог и квест заполнены, для Kill Boss указан **Kill Boss Target**.
- [ ] Для Fetch: на уровне есть **Item Pickup** с типом **Quest Key**.
- [ ] Для Kill Boss: на боссе висят **Enemy Health** и **Quest Target Boss**, этот босс перетащен в **Kill Boss Target** у NPC.
- [ ] У игрока тег **Player**.

Если что-то не срабатывает, проверь консоль на ошибки и что все ссылки в инспекторе заданы (не None).
